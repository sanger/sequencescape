
<% add :about, "This page details a registered sample." -%>
<% add :menu, (pluralize @sample.comments.size, "comment") => sample_comments_path(@sample) -%>
<% add :menu, 'Event history' => history_sample_path(@sample) -%>

<% add :back_menu, "Back to Studies" => studies_path -%>

<% if can? :edit, @sample -%>
  <% add :menu, "Edit" => edit_sample_path(@sample) -%>
<% end %>
<% if can? :release, @sample %>
  <% add :menu, { "Flag for public release" => url_for({controller: "samples", action: "release", id: @sample.id }) } -%>
<% end %>
<% if @sample.should_be_accessioned? & permitted_to_accession?(@sample) %>
  <% add :menu,
    @sample.accession_number? ? "Update Sample Data for Accessioning" : "Generate Accession Number" =>
     (accessioning_enabled? ? url_for({controller: 'samples', action: 'accession', id: @sample.id}) : 'disabled' ) -%>
<% end %>

<% if @sample.accession_number? %>
  <% add(:menu, "View data stored in ENA" => url_for(configatron.accession.view_url+@sample.ebi_accession_number)) -%>
<% end %>

<% @sample.studies.each do |study| %>
  <% add :menu, "Back to study #{study.name}" => study_path(study) -%>
  <% add :menu, "Back to samples for #{study.name}" => study_samples_path(study) -%>
<% end %>

<%= page_title "Sample Specification", @sample.sanger_sample_id %>

<% if @sample.consent_withdrawn? %>
  <%= alert(:danger) do %>
    <%= render partial: 'consent_withdrawn', locals: { sample: @sample } %>
  <% end %>
<% end %>

<div class="columnize">
  <%= render partial: 'summary', locals: { sample: @sample } %>
  <% if @sample.component_samples.any? %>
    <%= render partial: 'component_samples', locals: { sample: @sample } %>
  <% end %>
  <%= render partial: 'studies', locals: { sample: @sample, studies: @studies } %>
  <%= render partial: 'receptacles', locals: { sample: @sample } %>
  <%= render partial: 'asset_groups', locals: { sample: @sample } %>
  <%= render partial: 'submissions', locals: { sample: @sample } %>
  <% unless @sample.accession_sample_statuses.empty? %>
    <%# Some samples already have a number or some won't be accessioned %>
    <%= render partial: 'accession_statuses', locals: { sample: @sample } %>
  <% end %>
</div>
